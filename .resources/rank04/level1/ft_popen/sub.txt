[EN]
Assignment name  : ft_popen
Expected files   : ft_popen.c
Allowed functions: pipe, fork, dup2, execvp, close, exit
--------------------------------------------------------------------------------------

Write the following function:

int ft_popen(const char *file, char *const argv[], char type);

The function must launch the executable file with the arguments argv (using execvp).
If type is 'r' the function must return a file descriptor connected to the output of the command.
If type is 'w' the function must return a file descriptor connected to the input of the command.
In case of error or invalid parameter the function must return -1.

For example, the function could be used like that:

int main()
{
    int  fd;
    char *line;

    fd = ft_popen("ls", (char *const []){"ls", NULL}, 'r');
    while ((line = get_next_line(fd)))
        ft_putstr(line);
    return (0);
}


int	main() {
	int	fd = ft_popen("ls", (char *const []){"ls", NULL}, 'r');
	dup2(fd, 0);
	fd = ft_popen("grep", (char *const []){"grep", "c", NULL}, 'r');
	char	*line;
	while ((line = get_next_line(fd)))
		printf("%s", line);
}


Hints:
Do not leak file descriptors!
This exercise is inspired by the libc's popen().

[JA]
課題名         : ft_popen
提出ファイル   : ft_popen.c
使用可能な関数 : pipe, fork, dup2, execvp, close, exit
--------------------------------------------------------------------------------------

以下の関数を作成してください:

int ft_popen(const char *file, char *const argv[], char type);

この関数は、引数 argv を使用して実行可能ファイル file を起動する必要があります(execvp を使用)。
type が 'r' の場合、関数はコマンドの出力に接続されたファイルディスクリプタを返す必要があります。
type が 'w' の場合、関数はコマンドの入力に接続されたファイルディスクリプタを返す必要があります。
エラーまたは無効なパラメータの場合、関数は -1 を返す必要があります。

例えば、この関数は次のように使用できます:

int main()
{
    int  fd;
    char *line;

    fd = ft_popen("ls", (char *const []){"ls", NULL}, 'r');
    while ((line = get_next_line(fd)))
        ft_putstr(line);
    return (0);
}


int	main() {
	int	fd = ft_popen("ls", (char *const []){"ls", NULL}, 'r');
	dup2(fd, 0);
	fd = ft_popen("grep", (char *const []){"grep", "c", NULL}, 'r');
	char	*line;
	while ((line = get_next_line(fd)))
		printf("%s", line);
}


ヒント:
ファイルディスクリプタをリークさせないでください!
この課題は libc の popen() から着想を得ています。
